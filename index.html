<!-- This HTML file provides my portfolio page. It contains the answers of the coding challenge from the Data Visualisation course -->
<!-- It works with the portfolio_style css in this folder -->
<!-- The HTML file defines the structure of the page, and the CSS files define how it looks. -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Portfolio | Nicolas Rojas</title>

  <!-- Vega libraries -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="portfolio_style_v2.css" />
</head>

<body>
  <!-- ===========================
       HEADER + NAVIGATION
  ============================ -->
  <header class="site-header">
    <h1 class="site-title">Nicolas Rojas</h1>
    <nav class="nav">
      <a href="https://nicolasrojasv.github.io/index">Portfolio</a>
      <a href="https://nicolasrojasv.github.io/Project/project.html">Project</a>
      <a href="https://www.linkedin.com/in/nicolasrojasv/">LinkedIn</a>
      <a href="https://www.github.com/nicolasrojasv">GitHub</a>
    </nav>
  </header>

  <!-- ===========================
       MAIN CONTENT
  ============================ -->
  <main class="container">

    <!-- HERO / ABOUT -->
    <section id="about" class="section-card hero">
      <h1>Automated Data Visualisation Portfolio</h1>

      <p>
        Welcome to my <a href="https://nicolasrojasv.github.io/">website portfolio</a>.
        You can explore the source code and repository <a href="https://github.com/nicolasrojasv/nicolasrojasv.github.io">here</a>.
      </p>

      <p>
        This portfolio showcases how data visualisation and data science techniques can transform raw data into meaningful policy insights.
        It is hosted on GitHub Pages and built using Python for data processing and analysis, and HTML, CSS, and JavaScript
        (with JSON as the data exchange format) for presentation. The visualisations presented here follow the coding challenges from the
        Automated Data Visualisation for Policymaking course (2025).
      </p>
    </section>

    <!-- CC1 -->
    <section id="first_challenge" class="section-card">
      <h2>CC1: Hosting. Display charts in your own site.</h2>

      <p>
        The first task is to add two charts using the <em>vegaEmbed</em> function.<br />
        The graphs that I selected are taken from the Tennis time, Wimbledon Economics in the Economics Observatory webpage.
      </p>

      <p>
        Chart 1 shows how the prize for winning Wimbledon has evolved by event.
        It is immediately noticeable that the prize for singles tournaments has increased significantly
        more than that for doubles tournaments. Moreover, since 2005, the same amount has been awarded
        for both the men’s and women’s singles tournaments.
      </p>

      <h3>Task 1. Chart 1: Winning prize money by event.</h3>

      <figure class="chart">
        <div id="Location1"></div>
        <figcaption>
          Source: Tennis time, Economics Observatory. Data source: Wimbledon, AELTC (2025)
        </figcaption>
      </figure>

      <script>
        let figure_1_spec = "graphs/fig3_prize-category.json"; 
        vegaEmbed("#Location1", figure_1_spec);
      </script>

      <p>
        Tennis is a highly unequal sport. Those who advance through consecutive rounds in major
        tournaments are able to finance their seasons, while those who remain at lower levels face
        severe financial constraints in developing their careers, since the costs of maintaining a
        professional tennis life are higher than the prize money from smaller tournaments.
        For lower-ranked players, qualifying for Wimbledon can be a financial lifesaver
        for the entire season. Graph 2 shows that, in relative terms, prize money in the early rounds
        of Wimbledon has increased more rapidly over the past 15 years than the amounts awarded in the
        final rounds. However, in absolute terms, the gap between early-round earnings and the top prizes
        is now even larger than it was 15 years ago. This means that, despite higher proportional gains for lower rounds,
        the overall structure remains highly unequal and may even reinforce perceptions of inequality.
      </p>

      <h3>Task 2. Chart 2: Prize winnings by round</h3>

      <figure class="chart">
        <div id="Location2"></div>
        <figcaption>
          Source: Tennis time, Economics Observatory. Data source: Wimbledon, AELTC (2025)
        </figcaption>
      </figure>

      <script>
        let figure_2_spec = "graphs/fig5_prize-distribution.json";
        vegaEmbed("#Location2", figure_2_spec);
      </script>
    </section>

    <!-- CC2 -->
    <section id="second_challenge" class="section-card">
      <h2>CC2: Building. Create your own visualisations</h2>

      <p>In this task, I created 2 graphs using the create tool in the Economics Observatory Data Hub.</p>

      <p>
        In the task 1, the chart illustrates the evolution of Great Britain's real GDP from 1955 to 2024. While the long-term trend shows a steady increase,
        the series includes several significant downturns, particularly over the past 35 years: the early-1990s recession,
        the 2008–2009 financial crises, and the sharp contraction during the COVID-19 pandemic. As shown in the figure, the pandemic
        produced the largest single drop in real GDP. However, among these three episodes, the post-COVID recovery was the fastest,
        with output returning to pre-pandemic levels within a relatively short period.
      </p>

      <h3>Task 1. Great Britain Real GDP</h3>

      <figure class="chart">
        <div id="Location3"></div>
        <figcaption>Source: Economics Observatory. Data Source: Office for National Statistics.</figcaption>
      </figure>

      <script>
        let figure_3_spec = "graphs/great_britain_gdp.json";
        vegaEmbed("#Location3", figure_3_spec);
      </script>

      <p>
        Unemployment is closely related to overall economic performance, particularly during periods of crisis. Chart 4 shows the
        unemployment rate in Great Britain from 1970 to 2025. When compared with Chart 3, it is possible to observe substantial
        increases in unemployment during the major downturns: roughly 5 percentage points in the early-1990s recession, around 3 points
        during the 2008–2009 financial crisis, and about 2 points during the COVID-19 pandemic. A key insight from the figure is
        that unemployment typically takes longer to return to its pre-crisis levels than real GDP, reflecting slower adjustments
        in labour markets.
      </p>

      <h3>Task 2. Great Britain Unemployment</h3>

      <figure class="chart">
        <div id="Location4"></div>
        <figcaption>Source: Economics Observatory. Data Source: Office for National Statistics.</figcaption>
      </figure>

      <script>
        let figure_4_spec = "graphs/great_britain_unemployment.json";
        vegaEmbed("#Location4", figure_4_spec);
      </script>
    </section>

    <!-- CC3 -->
    <section id="third_challenge" class="section-card">
      <h2>CC3: Debate. Use a visualisation in policy commentary</h2>

      <p>In this task, I created two graphs showing that boosting productivity is essential for 
        sustainable long-run growth in living standards, measured by GDP per capita, but that it does 
        not fully explain why some countries achieve stronger growth than others.</p>

      <p>Ireland stands out as an extreme case, combining very high measured productivity with one of the
         highest GDP per capita levels. However, productivity alone does not fully explain income 
         differences: despite having similar productivity levels since the 1990s, the United States has
         consistently maintained a higher GDP per capita than Germany. South Korea provides another 
         illustrative case: despite lower productivity levels than the United Kingdom, its GDP per capita
         has exceeded that of the UK since the late 2010s. These cases suggest that factors beyond
         productivity also play an important role in improving GDP per capita.</p>

      <h3>Task 2. Chart 1: GDP per capita</h3>

      <figure class="chart">
        <div id="Location5"></div>
        <figcaption>Source: Bolt and van Zanden – Maddison Project Database 2023. 
          Data obtained from Our World in Data.</figcaption>
      </figure>

      <script>
        let figure_5_spec = "graphs/gdp_per_capita_ppp.json";
        vegaEmbed("#Location5", figure_5_spec);
      </script>

      <h3>Task 2. Chart 2: Productivity</h3>

      <figure class="chart">
        <div id="Location6"></div>
        <figcaption>Source: Feenstra et al. - Penn World Table (2025). 
          Data obtained from Our World in Data.</figcaption>
      </figure>

      <script>
        let figure_6_spec = "graphs/productivity_ppp.json";
        vegaEmbed("#Location6", figure_6_spec);
      </script>
    </section>

    <!-- CC4 -->
    <section id="fourth_challenge" class="section-card">
      <h2>CC4: Replication. Re-create, then improve, someone else's chart</h2>

      <p>
        For this task I use a graph shown by former Chilean president Sebastián Piñera during a TV debate in the run-up to the 2018
        presidential election, which he eventually won. As shown in the image below, the chart aims to show that during his previous
        term in office (2010-2013) the delinquency rate fell and then rose again when the opposition coalition governed (2014-2017).
        However, a closer look at the figure reveals that the y-axis is truncated, artificially exaggerating the fall in delinquency
        during his administration.
      </p>

      <h3>Task 1. Sebastián Piñera's Crime Chart from the 2018 Presidential Debate</h3>

      <figure class="chart">
        <img src="graphs/pinera_crime_graph.png" alt="Pinera Crime Graph" width="400" />
        <figcaption>
          Source: Biobiochile.cl. The image is available
          <a href="https://www.biobiochile.cl/noticias/nacional/chile/2017/11/07/los-errores-del-grafico-que-mostro-pinera-durante-el-debate.shtml">here</a>.
        </figcaption>
      </figure>

      <p>
        I'm trying to replicate the exact graph using Vega Lite in Chart 7. The most challenging part was
        distorting the y axis, which I couldn't achieve in Vega-Lite.
      </p>

      <h3>Task 2. Replication of Piñera's crime graph</h3>

      <figure class="chart">
        <div id="Location7"></div>
      </figure>

      <script>
        vegaEmbed("#Location7", "graphs/replication_pinera_crime_graph.json");
      </script>

      <p>
        I improved the chart by using the full data series, correcting axis distortion, applying consistent scaling, clearer labels,
        and period grouping to make trends clear.
      </p>

      <h3>Task 3. Improving the victimisation rate graph</h3>

      <figure class="chart">
        <div id="Location8"></div>
        <figcaption>
          Source: National Urban Public Safety Survey (ENUSC).
          Data available <a href="https://www.ine.gob.cl/estadisticas/sociales/seguridad-publica-y-justicia/seguridad-ciudadana">here</a>.
        </figcaption>
      </figure>

      <script>
        vegaEmbed("#Location8", "graphs/pinera_crime_graph_improved.json");
      </script>
    </section>

    <!-- CC5 -->
    <section id="fifth_challenge" class="section-card">
      <h2>CC5: Accessing data: Scraper and API</h2>

      <p>
        In this task, I have to use an API and scrape data from a website so my portfolio has live access to a data sources.<br />
      </p>

      <h3>Task 1. Using an API</h3>

      <p>
        The chart below uses live temperature data from Open-Meteo.
      </p>

      <figure class="chart">
        <div id="Location9"></div>
        <figcaption>
          Source: Open-Meteo (2025). Weather Forecast API.
          Retrieved from <a href="https://open-meteo.com/">https://open-meteo.com/.</a>
        </figcaption>
      </figure>

      <script>
        vegaEmbed("#Location9", "graphs/api_temperature_london.json");
      </script>

      <div class="api-description">
        <h4>API Functional Description</h4>
        <p>
          The chart above uses the <strong>Open-Meteo Weather Forecast API</strong>, which provides free, no-key access to hourly and daily
          weather data. All requests are made to the base endpoint:
        </p>

        <p>https://api.open-meteo.com/v1/forecast</p>

        <p>To call the API, several parameters must be specified:</p>

        <p>

          <ul>
          <li><strong>latitude</strong> - geographic latitude of the location</li>
          <li><strong>longitude</strong> - geographic longitude</li>
          <li><strong>hourly</strong> - comma-separated list of hourly variables to retrieve (e.g., <em>apparent_temperature</em>, <em>relativehumidity_2m</em>)</li>
          <li><strong>forecast_days</strong> - number of days to include in the forecast</li>
          <li><strong>timezone</strong> - ensures timestamps match the local time of the location</li>
          </ul>

        </p>

        <p>The full API URL used in this visualisation is:</p>

        <pre>
https://api.open-meteo.com/v1/forecast?latitude=51.5&longitude=-0.1&hourly=apparent_temperature,relativehumidity_2m&forecast_days=7&timezone=Europe%2FLondon
        </pre>

        <p>
          The response returns JSON arrays for <code>hourly.time</code>,
          <code>hourly.apparent_temperature</code> and
          <code>hourly.relativehumidity_2m</code>, which are flattened
          and transformed in Vega-Lite to produce the chart above.
        </p>
      </div>

      <h3>Task 2. Scraping data from the ATP website</h3>

      <p>
      For this task, I scraped the table with the ATP rankings from the following 
      <a href="https://www.atptour.com/en/rankings/singles">website.</a> 
      The code for downloading information from the website can be found in the following
      <a href="https://github.com/nicolasrojasv/nicolasrojasv.github.io/blob/main/scripts/challenge_5_ranking_tennis_data.ipynb">
      Colab notebook.</a>
      The notebook extracts the complete table with more than 2,000 players from the ATP ranking, 
      which contains the total points accumulated during the 2025 season for each player. 
      This table is not available for download in CSV format. I had to clean up the table by removing 
      columns and rows that were not necessary for the analysis. In addition, I had to fix the players' 
      names because they contained additional characters.
      </p>
      
      <p>
      The graph compares the points accumulated by the players ranked first, second, third, and last 
      in the 2025 season. It highlights a strong concentration of points at the top of the ranking: 
      the first- and second-ranked players are separated from the third-ranked player by a substantially
      larger points gap than the gap between the third-ranked player and the last-ranked player. 
      This pattern indicates that competitive dominance during the season was concentrated among the 
      top two players.  
      </p>

      <figure class="chart">
        <div id="Location10"></div>
        <figcaption>Source: Retrieved from 
          <a href="https://www.atptour.com/en/rankings/singles">
            ATP Tour Website.
            </a>
          </figcaption>
      </figure>

      <script>
        vegaEmbed("#Location10", "graphs/atp_ranking_difference.json");
      </script>
    </section>

    <!-- CC6 -->
    <section id="sixth_challenge" class="section-card">
      <h2>CC6: Loops. Build a dashboard</h2>

      <p>
        In this challenge, I have two tasks. The first task is to download
        six different series as JSON files and save them to my GitHub account.
        The second task is to use this data to create six charts, 
        embedding them using a JavaScript loop. 
      </p>

      <h3>Task 1. Using a loop to download data</h3>

      <p>
        Returning to the ATP ranking chart from the previous challenge, 
        it is interesting to examine whether the top two players consistently 
        dominate across seasons. To explore this, this 
        <a href="https://github.com/nicolasrojasv/nicolasrojasv.github.io/blob/main/scripts/challenge_6_atp_ranking_data_across_seasons.ipynb">
        Colab notebook</a> scrapes data for six additional seasons using a loop
        that retrieves the ATP year-end rankings for the 2004, 2008, 2012, 2016, 
        2020, and 2024 seasons.
      </p>

      <p>
        The six data sets can be found 
        <a href="https://github.com/nicolasrojasv/nicolasrojasv.github.io/tree/main/data">
        here</a>.
      </p>

      <h3>Task 2. Building a Dashbord using a loop</h3>
      <h3>Distance in points accumulated by ranking and season</h3>

      <p>
        The dashboard compares the points accumulated by the players ranked first, second, third and last over several seasons. 
        It shows that the large point differences between the top two players and the rest of the rankings are not repeated in all periods. 
        The magnitude of the difference observed in 2025 can be compared to the 2016 season. However, in other seasons (particularly 2008 and 2020),
        the top of the rankings is more compressed. Overall, the pattern suggests that competitive dominance at the top of men's tennis is cyclical
        rather than constant, with periods of extreme concentration alternating with more competitive seasons.
      </p>
     
      <figure class="charts">
            <figure id="c1" class="chart"></figure>
            <figure id="c2" class="chart"></figure>
            <figure id="c3" class="chart"></figure>
            <figure id="c4" class="chart"></figure>
            <figure id="c5" class="chart"></figure>
            <figure id="c6" class="chart"></figure>
        <figcaption>Source: Retrieved from 
          <a href="https://www.atptour.com/en/rankings/singles">
            ATP Tour Website.
          </a>
        </figcaption>
      </figure>

      <!-- /////// JAVASCRIPT: LOOP WITH VEGA EMBED /////// -->
        <script>

            // 1. DEFINE TEMPLATE SPEC FOR CHART
            let templateSpec = {
                "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
                "title": {
                    "text": "",
                    "fontSize": 16,
                    "fontWeight": "normal",
                    "anchor": "middle"
                },
                "height":150,
                "width": 350,
                "padding": {"left": 85, "right": 10, "top": 5, "bottom": 5},
                "view": { "fill": "white", "strokeOpacity": 0},
                "data":{
                    "url": "", // Added from loop
                    "format":{
                        "type": "json",
                        "parse": { "rank": "number", "points": "number" }
                    }},
                    "transform": [
  { "joinaggregate": [{ "op": "max", "field": "rank", "as": "max_rank" }] },

  {
  "window": [{ "op": "row_number", "as": "rn_in_rank" }],
  "groupby": ["rank"],
  "sort": [{ "field": "points", "order": "descending" }]
},

  {
    "calculate": "datum.rank==1 || datum.rank==2 || datum.rank==3 || (datum.rank==datum.max_rank && datum.rn_in_rank==1)",
    "as": "highlight"
  },
  { "calculate": "'N°' + datum.rank", "as": "rank_label" },

  { "filter": "datum.highlight" },

  {
    "window": [
      { "op": "lag", "field": "points", "as": "prev_points" },
      { "op": "lead", "field": "points", "as": "next_points" }
    ],
    "sort": [{ "field": "points", "order": "ascending" }]
  },
  { "calculate": "isValid(datum.prev_points) ? datum.points - datum.prev_points : null", "as": "diff_prev" },
  { "calculate": "isValid(datum.next_points) ? datum.points - datum.next_points : null", "as": "diff_next" },
  { "calculate": "isValid(datum.diff_prev) ? abs(datum.diff_prev) : 1000", "as": "gap_prev" },
  { "calculate": "isValid(datum.diff_next) ? abs(datum.diff_next) : 1000", "as": "gap_next" },
  { "calculate": "datum.gap_prev <= datum.gap_next ? datum.diff_prev : datum.diff_next", "as": "diff_neigh" },
  { "calculate": "min(datum.gap_prev, datum.gap_next)", "as": "min_gap" },
  { "calculate": "datum.min_gap < 1000", "as": "needs_push" },
  {
    "calculate": "datum.highlight && datum.needs_push ? (datum.points + (datum.diff_neigh > 0 ? 500 : -500)) : datum.points",
    "as": "points_adj"
  }
  ],

   "layer": [
    {
      "mark": { "type": "rule", "strokeWidth": 2, "opacity": 0.5, "dy": 20 },
      "encoding": {
        "x": { "aggregate": "min", "field": "points", "type": "quantitative", 
        "axis": {"title": null} },
        "x2": { "aggregate": "max", "field": "points" }
      }
    },

    {
      "transform": [{ "filter": "datum.highlight" }],
      "mark": { "type": "circle", "size": 200, "stroke": "white", "strokeWidth": 1.5 },
      "encoding": {
        "x": { "field": "points", "type": "quantitative", "axis": null },
        "color": { "value": "#4c78a8" }
      }
    },

    {
  "transform": [{ "filter": "datum.highlight" }],
  "mark": { "type": "rule", "strokeWidth": 1.2, "opacity": 0.8, "dy": 20},
  "encoding": {
    "x": { "field": "points", "type": "quantitative" },
    "x2": { "field": "points_adj" },
    "y2": { "value": 98 }
  }
},

{
  "transform": [{ "filter": "datum.highlight" }],
  "mark": { "type": "point", "shape": "triangle-down", "size": 60, "color": "black", "fill" : "black"},
  "encoding": {
    "x": { "field": "points_adj", "type": "quantitative" },
    "y": { "value": 98 }
  }
},

    {
  "transform": [
    { "calculate": "datum.rank == 3 ? datum.points : null", "as": "p3_tmp" },
    {
      "joinaggregate": [
        { "op": "max", "field": "rank", "as": "max_rank" },
        { "op": "max", "field": "p3_tmp", "as": "rank3_points" }
      ],
      "groupby": []
    },
    { "filter": "datum.rank == 2 || datum.rank == datum.max_rank" },

    { "calculate": "min(datum.points, datum.rank3_points)", "as": "x_left" },
    { "calculate": "max(datum.points, datum.rank3_points)", "as": "x_right" },
    { "calculate": "(datum.points + datum.rank3_points)/2", "as": "x_mid" },
    { "calculate": "format(datum.diff_rank_three, ',.0f') + ' points'", "as": "diff_label"}
  ],
  "layer": [
    {
      "mark": { "type": "rule", "strokeWidth": 1.6, "opacity": 0.75 },
      "encoding": {
        "x": { "field": "x_left", "type": "quantitative" },
        "x2": { "field": "x_right" },
        "y": { "value": 50 }
      }
    },
    {
      "mark": { "type": "rule", "strokeWidth": 1.6, "opacity": 0.75 },
      "encoding": {
        "x": { "field": "x_left", "type": "quantitative" },
        "y": { "value": 50 },
        "y2": { "value": 65 }
      }
    },
    {
      "mark": { "type": "rule", "strokeWidth": 1.6, "opacity": 0.75 },
      "encoding": {
        "x": { "field": "x_right", "type": "quantitative" },
        "y": { "value": 50 },
        "y2": { "value": 65 }
      }
    },
    {
      "mark": { "type": "rule", "strokeWidth": 1.6, "opacity": 0.75 },
      "encoding": {
        "x": { "field": "x_mid", "type": "quantitative" },
        "y": { "value": 50 },
        "y2": { "value": 40 }
      }
    },
    {
      "mark": { "type": "text", "fontSize": 14, "fontWeight": "bold" },
      "encoding": {
        "x": { "field": "x_mid", "type": "quantitative" },
        "y": { "value": 25 },
        "text": { "field": "diff_label", "type": "nominal"}
      }
    }
  ]
},

 {
  "layer": [

    {
      "mark": { "type": "text", "dy": 35, "fontSize": 14, "fontWeight": "bold" },
      "encoding": {
        "x": { "field": "points_adj", "type": "quantitative" },
        "text": { "field": "last_name" }
      }
    },
    {
      "mark": { "type": "text", "dy": 50, "fontSize": 14, "fontWeight": "bold" },
      "encoding": {
        "x": { "field": "points_adj", "type": "quantitative" },
        "text": { "field": "rank_label" }
      }
    },
    {
      "mark": { "type": "text", "dy": 65, "fontSize": 14, "fontWeight": "bold" },
      "encoding": {
        "x": { "field": "points_adj", "type": "quantitative" },
        "text": { "field": "points" }
      }
    }
  ]
}


  ],

  "config": { "text": { "font": "calibri" } }
}

            // 2. DEFINE LIST OF CHART FILE LINKS. (EITHER LOCAL OR RAW ONLINE)
            let chartFiles = [
                // DEFINE LIST OF CHART FILE LINKS 
                "atp_ranking_2004.json",
                "atp_ranking_2008.json",
                "atp_ranking_2012.json",
                "atp_ranking_2016.json",
                "atp_ranking_2020.json",
                "atp_ranking_2024.json",
            ]

            // 3. DEFINE BASE URL FOR CHART FILES (i.e. raw folder link, without the file name)

            // Note that this will need to be changed to YOUR github account to run your data. 
            let baseUrl = "https://raw.githubusercontent.com/nicolasrojasv/nicolasrojasv.github.io/main/data/";

            // WE HAVE 4 CHART DIVS, SO WE NEED TO LOOP 4 TIMES
            for(let i=0; i<6; i++) {
                // Add chartFile to base url
                let url = baseUrl + chartFiles[i];  
                
                // Make a copy of the template spec, so we can modify it for each chart.
                let spec = JSON.parse(JSON.stringify(templateSpec));
                spec.data.url = url;   // Set the data url
                spec.title.text = chartFiles[i].match(/\d{4}/)[0] + " season"; 
                
                // Print the spec to the console (helpful for debugging)
                console.log(spec);

                // Select the chart div
                let chartDiv = document.getElementById(`c${i+1}`);

                // Embed our modified spec into the chart div
                vegaEmbed(chartDiv, spec);
            }

        </script>
    </section>

    <!-- CC7 -->
    <section id="seventh_challenge" class="section-card">
      <h2>CC7: Maps. Base maps and choropleths</h2>

      <p>In this task, I have to produce two maps. The coordinates map is about ... in Scotland whereas 
         the choropleth shows ... in Wales.</p>

      <h3>Map 1. Scotland coordinates map </h3>

      <figure class="chart">
        <div id="Location12"></div>
        <figcaption>Source: MAP?</figcaption>
      </figure>

      <script>
        let figure_12_spec = "maps/Scotland_map.json";
        vegaEmbed("#Location12", figure_12_spec);
      </script>
    </section>

    <!-- CC8 -->
    <section id="eighth_challenge" class="section-card">
      <h2>CC8: Big data. Extracting a story from millions of prices.</h2>

      <p>
        For this task, I will construct two time series using the AutoCPI database. 
        I will compare purchases for breakfast and lunch at the most expensive and cheapest supermarkets.
      </p>

      <p>
        The code for the two graphs can be found here.
        The database used is AutoCPI (Davies and McElvoy, 2024). This database contains two files,
        one with the daily prices of supermarket products from July 2023 to November 2025 and the other 
        with the product descriptions. What I did was join the databases to obtain the product 
        descriptions for each date. Then I used a class code to see which supermarkets had the highest
        and lowest average and median prices. Supermarket 1 has the highest prices, while supermarket 5 
        has the lowest. However, store 5 has information up to March 2025, while store 1 has information 
        up to November 2025. Therefore, I discarded store 5 and replaced it with store 4, which has the 
        second lowest average and median prices among all stores.
      </p>

      <p>
        The analysis in the notebook shows that the median price is around £1.50 lower than the average
        price in both shops, and the difference between the median prices of both shops is less than the
        average price. For this reason, the median price is used in the comparison.
      </p>

      <h3>
        Task 1. Comparing the price of breakfast products between the cheapest and most expensive
        supermarkets.
      </h3>

      <p>
        To calculate the median price of breakfast, products with the following descriptions were selected:
        "Semi-Skimmed Milk", "Coffee", "Bread, White" and "Egg". The median price was calculated by segment 
        code, store ID and for each month (the date was first converted to month-year). The median price of 
        these segments was then added up for each store and period.To ensure a fair comparison, only segment 
        codes present over the entire period in each store were considered.
      </p>

      <p>
        The graph below shows that until around May 2024, the median price of breakfast at store 4 was 
        consistently higher than at store 1. From mid-2024 onward, this pattern reverses: 
        store 1 overtakes store 4 and remains the higher-priced store for the rest of the analysis period.
        Moreover, the price gap between the two stores widens over time, indicating a growing divergence 
        in median breakfast prices after this turning point.
      </p>

      <figure class="chart">
        <div id="Location13"></div>
        <figcaption>Source: AutoCPI data (Davies and McElvoy, 2024).</figcaption>
      </figure>

      <script>
        vegaEmbed("#Location13", "graphs/breakfast_comparison_chart.json");
      </script>

          <h3>
        Task 2. Comparing the price of lunch products between the cheapest and most expensive
        supermarkets.
      </h3>

      <p>
        To calculate the median price of lunch the same procedure was followed as in the case of breakfast,
        but selection products for lunch: products with the following descriptions were selected: 
        "MEAT OF CHICKEN", "RICE", "TOMATO", "CARROT" and "BUTTER, DERIVED".
      </p>

      <p>
        Interestingly, lunch product prices follow a time pattern similar to that observed for breakfast
        products. Store 1’s prices overtake those of Store 4 in July 2024, and by November 2025 the two
        converge again.
      </p>

      <figure class="chart">
        <div id="Location14"></div>
        <figcaption>Source: AutoCPI data (Davies and McElvoy, 2024).</figcaption>
      </figure>

      <script>
        vegaEmbed("#Location14", "graphs/lunch_comparison_chart.json");
      </script>
    </section>

        <!-- CC9 -->
    <section id="nineth_challenge" class="section-card">
      <h2>CC9: Two interactive charts.</h2>

      <p>
        For this task, I am using two graph from my 
        <a href="https://nicolasrojasv.github.io/Project/project_index.html"> Project</a>. 
        The explanation of the data collection and cleaning process can be found there. 
      </p>

      <h3>
        Task 1. Using a slider to select a year.
      </h3>

      <p>
        The slider allows users to select the year, enabling the Lorenz curves and the Gini indices shown
        in the legend to update accordingly.
      </p>

      <figure class="chart">
        <div id="Location15"></div>
        <figcaption>Source: ATP website and the World Bank API.</figcaption>
      </figure>

      <script>
        vegaEmbed("#Location15", "graphs/atp_lorenz_curve_gini_v2.json");
      </script>

          <h3>
        Task 2. Using a drop-down box as if filtering a dataset.
      </h3>

      <p>
        The selector helps display different Gini index outcomes for the ATP Tour depending on the number 
        of ranked players included in the calculation.
      </p>


      <figure class="chart">
        <div id="Location16"></div>
        <figcaption>Source: ATP website and the World Bank API..</figcaption>
      </figure>

      <script>
        vegaEmbed("#Location16", "graphs/gini_time_series.json");
      </script>
    </section>

     <!-- CC10 -->
    <section id="tenth_challenge" class="section-card">
      <h2>CC10: Advance analytics and Machine Learning.</h2>

      <p>
        For this task, I am using two graph from my 
        <a href="https://nicolasrojasv.github.io/Project/project_index.html"> Project</a>. 
      </p>

      <h3>
        Task 1. Advanced analytics chart.
      </h3>

      <p>
        In this advanced chart, the visualization is made interactive because density plots are often 
        difficult to interpret in the presence of large outliers. Interaction allows for a clearer and 
        more intuitive understanding of the underlying data distribution.
      </p>

      <figure class="chart">
        <div id="Location17"></div>
        <figcaption>Source: ATP website.</figcaption>
      </figure>

      <script>
        vegaEmbed("#Location17", "graphs/prize_money_distribution.json");
      </script>

          <h3>
        Task 2. Machine Learning.
      </h3>

      <p>
        The hypothesis is that players who accumulate higher total prize money over their careers tend to
        remain longer on the professional circuit, implying a positive relationship between cumulative
        earnings and years on tour.
      </p>

      <p>
        The figure shows a clear positive relationship between predicted and actual career length. 
        Although the R² is relatively high, it is important to note that the model exhibits substantial
        dispersion when predicting shorter careers, frequently overestimating or underestimating career 
        length by as much as a factor of two. This pattern indicates that cumulative earnings alone do not
        fully determine career longevity, pointing to the relevance of additional factors, 
        such as injuries, sponsorships or access to institutional support, in shaping professional tennis
        careers.
      </p>


      <figure class="chart">
        <div id="Location18"></div>
        <figcaption>Source: ATP website and The Federal Reserve Bank.</figcaption>
      </figure>

      <script>
        vegaEmbed("#Location18", "graphs/predicting_longevity.json");
      </script>
    </section>

    <!-- CONTACT (for navbar) -->
    <section id="contact" class="section-card">
      <h2>Contact</h2>
      <p>
        You can reach me via LinkedIn or GitHub:
        <a href="https://www.linkedin.com/in/nicolasrojasv/">LinkedIn</a> ·
        <a href="https://www.github.com/nicolasrojasv">GitHub</a>
      </p>
    </section>

  </main>

  <!-- ===========================
       FOOTER
  ============================ -->
  <footer class="site-footer">
    <p>© 2025 Nicolas Rojas.</p>
  </footer>
</body>
</html>